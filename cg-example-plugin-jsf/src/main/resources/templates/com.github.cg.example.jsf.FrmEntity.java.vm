package ${app.pkgs.controller}.frm;

#if( $entity.getAttributesManyToOne().size() > 0 )
import java.util.List;
import javax.ejb.EJB;
#end

#if( $entity.getAttributesOneToMany().size() > 0 )
import java.util.Collection;
import javax.inject.Inject;
#end

import javax.inject.Named;

import com.github.cg.example.jsf.annotations.HandlesError;
import ${app.pkgs.model}.${entity.name};
import ${app.pkgs.manager}.${entity.name}Manager;

#foreach( $attr in $entity.getAttributesManyToOne() )
import ${app.pkgs.model}.${attr.typeName};
import ${app.pkgs.manager}.${attr.typeName}Manager;
#end

#foreach( $attr in $entity.getAttributesOneToMany() )
import ${app.pkgs.model}.${attr.associationClassName};
import ${app.pkgs.controller}.frm.Frm${attr.associationClassName};
#end

@Named
@HandlesError
public class Frm${entity.name} extends Frm<${entity.name}Manager,${entity.name},${entity.attributeIdClass}> {

	private static final long serialVersionUID = 1L;
#foreach( $attr in $entity.getAttributesManyToOne() )

	@EJB
	private ${attr.typeName}Manager ${attr.typeNameFlc}Manager;
#end
#foreach( $attr in $entity.getAttributesOneToMany() )
	private FrmAssociationOneToMany<Frm${entity.name},${entity.name},Frm${attr.associationClassName},${attr.associationClassName}> association${attr.nameFuc};
#end	
#foreach( $attr in $entity.getAttributesManyToOne() )

	public List<${attr.typeName}> onComplete${attr.typeName}(String suggest) {
		return this.${attr.typeNameFlc}Manager.retrieveBySuggestOrderByDescription(suggest);
	}
#end
#if( $entity.getAttributesOneToMany().size() > 0 )

	@Inject
	public void initAssociations(#foreach( $attr in $entity.getAttributesOneToMany() )Frm${attr.associationClassName} frm${attr.associationClassName}#if( $foreach.hasNext ), #end#end) throws Exception {
#foreach( $attr in $entity.getAttributesOneToMany() )
		
		this.association${attr.nameFuc} = new FrmAssociationOneToMany<Frm${entity.name},${entity.name},Frm${attr.associationClassName},${attr.associationClassName}>(this, frm${attr.associationClassName}, "tbView:dt${attr.nameFuc}") {

			@Override
			public void connect(${attr.associationClassName} association, ${entity.name} entity) {
				association.set${attr.associationMappedByFuc}(entity);
			}

			@Override
			public Collection<${attr.associationClassName}> getAssociations(${entity.name} entity) {
				return entity.get${attr.nameFuc}();
			}
		};
#end
	}
#end
#foreach( $attr in $entity.getAttributesOneToMany() )
	
	public FrmAssociationOneToMany<Frm${entity.name},${entity.name},Frm${attr.associationClassName},${attr.associationClassName}> getAssociation${attr.nameFuc}() {
		return association${attr.nameFuc};
	}
#end
}